import os
import io
import pytest
import sys
import pandas as pd


sys.path.insert(0, os.path.abspath(os.path.dirname(__file__)))
from transform import process_temp_data, process_crop_data
from save import save_crop_data_to_csv, save_temperature_data_to_csv

data_dir = 'data'
temp_files = [
    'temp_change_annual.csv',
    'temp_change_seasonal.csv',
    'temp_change_met.csv',
    'std_dev_annual.csv',
    'std_dev_seasonal.csv',
    'std_dev_met.csv'
]
crop_files = [
    'ire_crop_prod.csv',
    'ire_crop_yield_per_hec.csv'
]


@pytest.fixture(scope='module')
def temp_data():
    data = """
,Area Code,Area Code (M49),Area,Months Code,Months,Element Code,Element,Unit,Y1961,Y1962,Y1963,Y1964,Y1965,Y1966,Y1967,Y1968,Y1969,Y1970,Y1971,Y1972,Y1973,Y1974,Y1975,Y1976,Y1977,Y1978,Y1979,Y1980,Y1981,Y1982,Y1983,Y1984,Y1985,Y1986,Y1987,Y1988,Y1989,Y1990,Y1991,Y1992,Y1993,Y1994,Y1995,Y1996,Y1997,Y1998,Y1999,Y2000,Y2001,Y2002,Y2003,Y2004,Y2005,Y2006,Y2007,Y2008,Y2009,Y2010,Y2011,Y2012,Y2013,Y2014,Y2015,Y2016,Y2017,Y2018,Y2019,Y2020,Y2021,Y2022,Y2023
0,3,'008,Albania,7001,January,7271,Temperature change,°c,0.186,1.416,-1.782,-2.32,0.63,-1.501,-1.887,-2.29,-0.882,1.785,2.409,1.643,0.225,0.751,-0.64,-0.031,1.228,0.14,-0.537,-1.651,-2.58,0.297,0.571,1.055,-0.974,0.623,-0.21,2.491,-0.747,-1.019,-0.614,-0.148,-0.392,2.013,-0.101,1.107,1.975,1.904,0.997,-2.589,3.002,-0.899,1.928,-0.508,0.328,-1.15,2.669,1.235,1.2,0.993,0.903,-1.068,1.372,3.38,1.105,1.222,-2.671,2.239,-1.02,1.073,1.908,0.561,2.704
1,3,'008,Albania,7001,January,6078,Standard Deviation,°c,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479,1.479
2,3,'008,Albania,7002,February,7271,Temperature change,°c,-0.611,-2.121,-0.618,-0.931,-4.308,2.847,-1.221,1.317,0.441,0.124,-0.451,1.457,-0.081,1.718,-1.516,-0.36,3.208,0.855,1.356,-0.391,-1.196,-1.856,-2.311,-0.327,-3.477,-0.646,0.762,0.143,1.192,2.261,-1.776,-1.14,-2.121,0.361,2.193,-1.04,0.709,2.21,-1.453,-0.15,1.256,3.062,-3.839,0.406,-2.547,-0.485,2.279,0.973,-0.819,0.816,0.555,-2.736,1.172,3.35,0.255,4.456,2.463,0.63,1.381,2.182,2.099,1.417,0.616
3,3,'008,Albania,7002,February,6078,Standard Deviation,°c,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936,1.936
4,3,'008,Albania,7003,March,7271,Temperature change,°c,1.0,-0.788,-1.487,0.678,0.091,-0.637,0.477,-0.365,-0.154,-0.045,-2.363,1.602,-2.031,1.01,1.321,-1.068,1.996,0.646,1.92,-0.099,2.058,-0.717,0.738,-0.904,0.133,0.928,-4.355,-0.824,2.589,2.835,2.152,-0.015,-0.922,2.149,-0.478,-2.156,0.169,-1.517,0.874,-0.195,4.253,2.756,-0.384,0.469,-0.192,-0.009,2.225,1.861,0.001,0.994,1.433,2.011,1.35,2.264,0.727,1.541,3.264,1.619,2.965,1.675,0.166,-0.938,2.014
5,3,'008,Albania,7003,March,6078,Standard Deviation,°c,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355,1.355
6,3,'008,Albania,7004,April,7271,Temperature change,°c,2.419,0.52,0.603,0.175,-1.073,1.286,-0.663,2.171,-0.661,0.296,0.583,1.144,-1.505,-1.145,0.083,-0.236,-0.189,-0.723,-1.181,-1.927,0.499,-0.858,1.576,-1.11,0.94,1.314,-0.2,-0.107,2.016,0.528,-1.073,0.278,0.326,0.567,-0.67,-0.457,-3.467,1.339,1.444,2.384,-0.228,0.471,-0.644,1.429,0.159,1.471,1.857,1.007,1.848,1.809,1.515,1.209,2.488,0.96,0.477,3.322,0.81,4.671,1.67,0.953,-0.481,0.854,-0.249
7,3,'008,Albania,7004,April,6078,Standard Deviation,°c,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193,1.193
8,3,'008,Albania,7005,May,7271,Temperature change,°c,-0.515,0.571,-0.07,-0.471,-0.776,-0.365,0.347,2.71,2.348,-1.963,1.548,0.098,1.049,-1.531,0.554,-0.047,0.944,-1.254,0.284,-2.096,-0.497,0.399,1.261,-0.058,1.624,1.738,-1.573,1.046,-0.768,0.672,-2.548,0.466,1.317,1.411,-0.075,1.393,1.307,0.246,1.768,2.297,1.735,0.97,3.526,-1.232,1.44,1.087,1.964,1.293,2.299,1.01,0.78,0.845,2.079,-0.042,2.216,0.012,1.291,3.286,-0.913,1.348,1.118,2.336,0.765
9,3,'008,Albania,7005,May,6078,Standard Deviation,°c,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176,1.176
10,3,'008,Albania,7006,June,7271,Temperature change,°c,0.173,-0.769,0.451,1.049,0.171,0.129,-1.467,-0.277,-1.015,0.12,0.07,1.187,0.027,-0.841,-0.589,-0.969,-0.34,-0.155,1.152,-1.139,1.312,1.591,-1.331,-1.092,-0.437,0.032,-0.059,-0.026,-1.637,0.331,0.388,-0.321,0.949,0.47,0.472,1.225,1.394,1.528,1.381,1.931,0.299,1.885,3.988,0.564,0.347,0.49,2.508,1.814,0.474,0.849,1.419,3.023,0.785,0.908,1.212,1.87,2.694,1.689,3.256,0.225,2.101,3.916,1.744
11,3,'008,Albania,7006,June,6078,Standard Deviation,°c,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873,0.873
12,3,'008,Albania,7007,July,7271,Temperature change,°c,-0.339,0.358,1.18,-0.527,0.897,-0.083,0.128,-0.112,-1.431,-0.475,-0.865,-0.449,0.4,-0.254,-0.257,-0.788,0.526,-0.579,-0.71,-0.504,-0.767,0.241,0.688,-0.756,0.567,-0.54,2.198,3.133,0.153,0.943,0.075,-0.406,0.143,1.464,1.179,0.087,0.272,1.671,0.613,1.151,1.738,1.637,2.303,1.102,1.024,1.28,2.915,1.511,1.333,1.621,1.201,3.744,1.368,0.228,3.7,2.24,2.646,1.392,1.72,1.722,3.186,3.101,3.414
13,3,'008,Albania,7007,July,6078,Standard Deviation,°c,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721,0.721
14,3,'008,Albania,7008,August,7271,Temperature change,°c,-0.161,2.031,1.233,-0.719,-1.327,0.834,0.976,-1.879,-0.573,0.175,1.296,-1.187,-0.307,0.74,-0.814,-3.231,-0.142,-1.068,-1.084,0.091,-0.024,0.44,-0.667,-1.129,0.779,1.548,0.185,2.039,0.203,0.535,0.036,2.937,2.012,2.548,-0.5,0.672,-0.471,2.597,2.012,2.063,2.609,0.144,3.317,0.502,0.038,0.495,2.133,2.261,1.977,2.351,2.356,3.002,2.717,1.354,3.092,1.317,3.313,2.637,3.154,2.262,3.044,2.348,2.364
15,3,'008,Albania,7008,August,6078,Standard Deviation,°c,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296,1.296
16,3,'008,Albania,7009,September,7271,Temperature change,°c,0.568,1.05,1.211,-0.892,0.444,0.289,0.513,-0.444,0.638,0.201,-2.106,-2.025,1.18,0.634,1.678,-1.76,-1.24,-2.165,-0.465,0.017,0.344,2.364,-0.269,-0.181,0.7,1.086,3.498,0.49,0.099,-0.269,0.912,0.688,0.321,2.871,-0.996,-2.354,0.362,-0.039,1.573,0.609,0.114,-1.153,0.0,0.516,0.952,0.859,-0.615,-0.224,1.584,0.216,3.845,2.598,0.83,0.181,2.684,0.664,0.832,2.246,2.605,2.935,1.192,0.969,2.953
17,3,'008,Albania,7009,September,6078,Standard Deviation,°c,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189,1.189
18,3,'008,Albania,7010,October,7271,Temperature change,°c,1.064,0.975,-0.091,0.759,-0.378,3.125,1.68,-0.31,-0.104,-1.116,-1.799,-3.5,0.464,-1.06,0.01,0.974,-0.428,-0.933,0.251,0.762,1.597,1.122,-0.66,1.952,-0.436,0.619,0.849,0.321,-0.866,1.808,0.307,1.83,1.983,1.016,0.167,-0.739,-1.376,1.009,1.776,1.546,2.776,0.277,0.384,2.752,0.35,1.809,0.096,1.069,0.049,-0.46,-0.107,2.783,1.708,0.952,1.614,0.895,0.517,2.647,2.87,1.271,-0.096,1.941,4.086
19,3,'008,Albania,7010,October,6078,Standard Deviation,°c,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293,1.293
20,3,'008,Albania,7011,November,7271,Temperature change,°c,1.471,1.178,2.42,0.287,0.492,-0.27,0.685,0.7,1.627,0.123,-0.793,-0.418,-1.829,-1.122,-1.254,-0.343,1.052,-3.048,-0.087,0.604,-3.456,-0.985,-1.845,0.343,0.368,-0.919,0.35,-4.37,-1.048,1.535,0.042,0.65,-1.301,0.096,-2.657,0.909,0.318,-1.369,-0.038,2.98,-0.61,1.382,1.454,-0.184,-0.717,-1.12,-1.634,1.21,0.985,3.039,-0.829,2.5,1.83,1.913,1.848,0.51,0.08,1.95,3.44,1.172,2.202,1.95,1.691
21,3,'008,Albania,7011,November,6078,Standard Deviation,°c,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209,1.209
22,3,'008,Albania,7012,December,7271,Temperature change,°c,-0.319,-2.012,0.89,0.462,0.978,-0.557,-0.47,-0.662,-0.871,0.006,-0.517,-1.118,-0.432,-1.015,-0.269,-0.255,-1.612,1.396,1.267,-1.438,0.445,1.2,-0.655,-0.647,1.411,-2.386,0.432,-1.681,-0.457,-1.261,-3.553,-0.961,1.351,-0.177,1.427,0.145,0.275,-2.258,0.977,1.673,-4.308,0.281,-0.156,1.417,-0.046,0.274,-1.493,0.788,1.892,0.433,0.644,-0.97,-0.026,1.073,0.648,-0.891,0.237,-0.123,1.988,2.629,0.561,3.36,1.998
23,3,'008,Albania,7012,December,6078,Standard Deviation,°c,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232,1.232
24,3,'008,Albania,7016,DecJanFeb,7271,Temperature change,°c,0.649,-0.341,-1.471,-0.787,-1.072,0.775,-1.222,-0.481,-0.368,0.346,0.655,0.861,-0.325,0.679,-1.057,-0.22,1.394,-0.206,0.738,-0.258,-1.738,-0.371,-0.18,0.024,-1.699,0.463,-0.611,1.022,-0.412,0.262,-1.217,-1.614,-1.158,1.242,0.638,0.498,0.943,1.463,-0.905,-0.587,1.977,-0.715,-0.543,-0.086,-0.267,-0.56,1.741,0.238,0.39,1.234,0.63,-1.053,0.525,2.235,0.811,2.109,-0.366,1.035,0.079,1.748,2.212,0.846,2.227
25,3,'008,Albania,7016,DecJanFeb,6078,Standard Deviation,°c,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03,1.03
26,3,'008,Albania,7017,MarAprMay,7271,Temperature change,°c,0.968,0.101,-0.318,0.127,-0.586,0.095,0.054,1.505,0.511,-0.571,-0.077,0.948,-0.829,-0.555,0.653,-0.45,0.917,-0.444,0.341,-1.374,0.687,-0.392,1.192,-0.691,0.899,1.327,-2.043,0.038,1.279,1.345,-0.49,0.243,0.24,1.376,-0.408,-0.407,-0.664,0.023,1.362,1.495,1.92,1.399,0.833,0.222,0.469,0.85,2.015,1.387,1.383,1.271,1.243,1.355,1.972,1.061,1.14,1.625,1.788,3.192,1.241,1.325,0.268,0.751,0.843
27,3,'008,Albania,7017,MarAprMay,6078,Standard Deviation,°c,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675,0.675
28,3,'008,Albania,7018,JunJulAug,7271,Temperature change,°c,-0.109,0.54,0.955,-0.066,-0.086,0.293,-0.121,-0.756,-1.006,-0.06,0.167,-0.15,0.04,-0.118,-0.553,-1.663,0.015,-0.601,-0.214,-0.517,0.174,0.757,-0.437,-0.992,0.303,0.347,0.775,1.715,-0.427,0.603,0.166,0.737,1.035,1.494,0.384,0.661,0.398,1.932,1.335,1.715,1.549,1.222,3.203,0.723,0.47,0.755,2.519,1.862,1.261,1.607,1.659,3.256,1.623,0.83,2.668,1.809,2.884,1.906,2.71,1.403,2.777,3.122,2.507
29,3,'008,Albania,7018,JunJulAug,6078,Standard Deviation,°c,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687,0.687
30,3,'008,Albania,7019,SepOctNov,7271,Temperature change,°c,1.034,1.068,1.18,0.051,0.186,1.048,0.959,-0.018,0.72,-0.264,-1.566,-1.981,-0.062,-0.516,0.145,-0.376,-0.205,-2.049,-0.1,0.461,-0.505,0.834,-0.925,0.705,0.211,0.262,1.566,-1.186,-0.605,1.025,0.42,1.056,0.334,1.328,-1.162,-0.728,-0.232,-0.133,1.104,1.712,0.76,0.169,0.613,1.028,0.195,0.516,-0.718,0.685,0.873,0.932,0.97,2.627,1.456,1.015,2.049,0.69,0.476,2.281,2.972,1.793,1.099,1.62,2.91
31,3,'008,Albania,7019,SepOctNov,6078,Standard Deviation,°c,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848,0.848
32,3,'008,Albania,7020,Meteorological year,7271,Temperature change,°c,0.635,0.342,0.086,-0.169,-0.39,0.553,-0.082,0.062,-0.036,-0.137,-0.205,-0.081,-0.294,-0.128,-0.203,-0.677,0.53,-0.825,0.191,-0.422,-0.346,0.207,-0.088,-0.238,-0.072,0.6,-0.078,0.397,-0.041,0.809,-0.28,0.106,0.113,1.36,-0.137,0.006,0.111,0.821,0.724,1.084,1.551,0.519,1.026,0.472,0.217,0.39,1.389,1.043,0.977,1.261,1.125,1.546,1.394,1.285,1.667,1.558,1.196,2.103,1.751,1.567,1.589,1.585,2.122
33,3,'008,Albania,7020,Meteorological year,6078,Standard Deviation,°c,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44,0.44
    """
    return pd.read_csv(io.StringIO(data))

@pytest.fixture(scope='module')
def crop_data():
    data = """
"STATISTIC","Statistic Label","TLIST(A1)","Year","C02039V02469","Type of Crop","UNIT","VALUE"
"AQA04C2","Crop Yield per Hectare","2023","2023","012","Total oats","Tonnes","7"
"AQA04C2","Crop Yield per Hectare","2023","2023","0121","Winter oats","Tonnes","7.9"
"AQA04C2","Crop Yield per Hectare","2023","2023","0122","Spring oats","Tonnes","6.5"
"AQA04C2","Crop Yield per Hectare","2023","2023","013","Total barley","Tonnes","7"
"AQA04C2","Crop Yield per Hectare","2023","2023","0131","Winter barley","Tonnes","8.7"
"AQA04C2","Crop Yield per Hectare","2023","2023","0132","Spring barley","Tonnes","6.3"
"AQA04C3","Crop Production","2011","2011","0132","Spring barley","000 Tonnes","1085.8"
"AQA04C3","Crop Production","2012","2012","013","Total barley","000 Tonnes","1260.7"
"AQA04C3","Crop Production","2012","2012","02","Beans and peas","000 Tonnes","19.7"
"AQA04C3","Crop Production","2012","2012","03","Oilseed rape","000 Tonnes","58.7"
"AQA04C3","Crop Production","2012","2012","04","Potatoes","000 Tonnes","232"
    """
    return pd.read_csv(io.StringIO(data))
        
        
def test_temp_data(temp_data):
    # assert the mock data
    assert temp_data is not None
    assert not temp_data.empty
    
    # process the mock data
    result = process_temp_data(temp_data)
    
    # Check if result is not None
    assert result is not None
    
    # Check for the keys in the result dictionary after procesing the temperature data
    expected_keys = [
        'ire_temp_change_annual', 'ire_temp_change_seasonal', 'ire_temp_change_met',
        'ire_std_dev_annual', 'ire_std_dev_seasonal', 'ire_std_dev_met'
    ]
    for key in expected_keys:
        assert key in result
        
    # Check the structure of one of the DataFrames after processing temperature data
    df = result['ire_temp_change_annual']
    assert 'Y2021' in df.columns
    assert 'Y2022' in df.columns
    
    # save the mock data to csv
    save_temperature_data_to_csv(result)
    
    # load the csv and check if not empty
    for filename in temp_files:
        filepath = os.path.join(data_dir, filename)
        assert os.path.exists(filepath), f"{filepath} does not exist."
    
    

def test_crop_data(crop_data):
    assert crop_data is not None
    assert not crop_data.empty
    
    result = process_crop_data(crop_data)
    
    # Check if result is not None
    assert result is not None
    
    # Check for the keys in the result dictionary
    expected_keys = ['ire_crop_prod', 'ire_crop_yield_per_hec']
    for key in expected_keys:
        assert key in result

    # Check the structure of one of the DataFrames
    df = result['ire_crop_prod']
    assert 'VALUE' in df.columns
    assert 'Statistic Label' in df.columns
    
    # save the mock data to csv
    save_crop_data_to_csv(result)
    
    # load the csv and check if not empty
    for filename in crop_files:
        filepath = os.path.join(data_dir, filename)
        assert os.path.exists(filepath), f"{filepath} does not exist."

